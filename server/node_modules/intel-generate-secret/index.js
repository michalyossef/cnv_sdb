/**
 * extracted from https://github.com/balderdashy/sails
 * specifically: https://github.com/balderdashy/sails/blob/e0d8b3ea3a62c47c728141f83277a8a0047d0637/lib/hooks/session/generateSecret.js
 */
/**
 * Module dependencies
 */
var crypto = require('crypto');
var _ = require('lodash');


/**
 * Generate session secret
 * @return {[type]} [description]
 */
module.exports = function generateSecret() {

	// Combine random and case-specific factors into a base string
	var factors = {
		creationDate: (new Date()).getTime(),
		random: Math.random() * (Math.random() * 1000),
		nodeVersion: process.version
	};
	var basestring = '';
	_.each(factors, function(val) {
		basestring += val;
	});

	// Build hash
	var hash =
		crypto.createHash('md5')
			.update(basestring)
			.digest('hex');

	return hash;
};