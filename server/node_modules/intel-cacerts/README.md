intel-cacerts
=======

Easy to use access to certificate trust chain for Intel issued certs (both intranet and public)

__Changes in version 2.0__
intel-cacerts still uses a synchronous approach, so there is no change for the basic consumption.
However, it borrows heavily from @pdapel intel-cacerts-live. So... after each "get" of ca the certificate cache is updated. The process is seamless and should not slow down your original request (this was one complaint about intel-cacerts-live). 
The results are cached on disk for [timeToLive => defaulted to 7 days]


When calling internal https services you must trust Intel's CA certs or you will often get a SELF_SIGNED_CERT_IN_CHAIN or CERT_UNTRUSTED error

This module will help make that process easier for you by giving you a list of all pertinent CA certs in PEM (base64 format). You can use this array of certs when making your https requests.

Installation
-----------
If using [pixi](http://pixi-ui.apps1-fm-int.icloud.intel.com/#/)
```
npm install intel-cacerts --save
```
If NOT using [pixi](http://pixi-ui.apps1-fm-int.icloud.intel.com/#/)
```
npm install intel-cacerts --save --registry https://pixi.intel.com/
```

Usage
------
Barebones usage:
```
var ca = require('intel-cacerts').ca
```

Combine with service request
```
var request = require('request')
var ca = require('intel-cacerts').ca

var url = 'https://employeeportal.intel.com'
request.get({url: url, ca: ca}, function(error, response, body) {
  console.log(error, response, body)
})
```

If need to ensure that the cache is up to date:
```
var request = require('request')
var cacerts = require('intel-cacerts')

cacerts.ensureFreshCerts()
  .then(function() {
    var ca = cacerts.ca
    var url = 'https://employeeportal.intel.com'
    request.get({url: url, ca: ca}, function(error, response, body) {
      console.log(error, response, body)
    })
  })
```

Configuration
------
```cacerts.config(options)``` is used to configure options:
  * timeToLive - milliseconds - how old to allow the cache to get before refreshing
  * certUrl - string|array listing zip location(s) for trust chain
  * override - boolean|string to override certs with a specific set of certs in cases where making http calls to retrieve them at runtime is not possible
