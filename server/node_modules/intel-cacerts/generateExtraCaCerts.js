const yargs = require('yargs')

const cacerts = require('./index');
const args = yargs.usage('intel-cacerts [options]')
	.env('NODE')
	.option('output', {
		alias: ['extraCaCerts', 'o'],
		describe: 'Output file name (also can be provided via the NODE_EXTRA_CA_CERTS environment variable.)',
		demandOption: true
	})
	.alias('h', 'help')
	.epilog(`To connect to intel.com domains with npm's request or request-promise, the NODE_EXTRA_CA_CERTS environment variable must be in place and pointing to the output of this command`)
	.help()
	.argv;

if (typeof process.env.NODE_EXTRA_CA_CERTS == 'undefined') {
	console.warn('NODE_EXTRA_CA_CERTS missing\r\nOutputting file, but in order to use request or request-promise you will need to create the NODE_EXTRA_CA_CERTS environment variable ')
}

return cacerts.generateExtraCaCertsFile(args.output)

/*
// TODO
 // warn if version of node is incompatible
 */
